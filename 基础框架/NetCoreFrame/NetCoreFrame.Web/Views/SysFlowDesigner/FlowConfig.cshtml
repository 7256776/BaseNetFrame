@{
    Layout = null;
}

<div class="profile">
    <div class="tabbable-line tabbable-full-width">
        <ul class="nav nav-tabs">
            <li class="active">
                <a href="#tabRole" data-toggle="tab" v-on:click="doNav('WorkFlowRole')">流程角色</a>
            </li>
            <li>
                <a href="#tabClient" data-toggle="tab">授权客户维护</a>
            </li>
        </ul>
        <div class="tab-content" style="padding-top:5px;">
            <!--角色列表-->
            <div class="tab-pane active" id="tabRole">
                <div class="row profile-account">
                    <div class="col-md-3" style="padding-left:5px;padding-right:5px;">
                        <div class="portlet light bordered">
                            <div class="portlet-title tabbable-line">
                                <div class="caption caption-md">
                                    <i class="icon-globe theme-font hide"></i>
                                    <span class="caption-subject font-blue-madison bold uppercase">角色列表</span>
                                </div>
                                <div class="actions">
                                    <el-button-group>
                                        <el-button type="primary" size="mini" icon="fa fa-file-text-o fa-lg" v-on:click="doRoleAdd" ref="btnRoleAdd">新增</el-button>
                                        <el-button type="primary" size="mini" icon="fa fa-save fa-lg" v-on:click="doRoleEdit()" ref="btnRoleEdit">编辑</el-button>
                                        <el-button type="primary" size="mini" icon="fa fa-trash-o fa-lg" v-on:click="doRoleDel" ref="btnRoleDel">删除</el-button>
                                    </el-button-group>
                                </div>
                            </div>
                            <div class="portlet-body">
                                <ul class="ver-inline-menu tabbable margin-bottom-10">
                                    <li v-for="item in roleOptions.tableData" v-bind:class="item.id==roleOptions.currentRoleId ? 'active' : ''">
                                        <a data-toggle="tab" v-on:click="getUserByRole(item.id)">
                                            <el-tooltip effect="light" content="启用" placement="left">
                                                <i class="fa fa-user-circle-o" v-if="item.isActive" style="color:#00ff21;"></i>
                                            </el-tooltip>
                                            <el-tooltip effect="light" content="禁用" placement="left">
                                                <i class="fa fa-ban " v-if="!item.isActive" style="color:#ff0000;"></i>
                                            </el-tooltip>
                                            {{item.flowRoleName}}
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-9" style="padding-left:5px;padding-right:5px;">
                        <div class="portlet light bordered">
                            <div class="portlet-title tabbable-line">
                                <div class="caption caption-md">
                                    <i class="icon-globe theme-font hide"></i>
                                    <span class="caption-subject font-blue-madison bold uppercase">角色相关用户</span>
                                </div>
                            </div>
                            <div class="portlet-body">
                                <div class="tab-content">
                                    <div class="tab-pane active">
                                        <!--可扩展批量添加-->
                                        <div class="row">
                                            <div class="col-md-6 " style="padding-bottom:5px;">
                                                <el-button-group>
                                                    <el-button type="primary" size="mini" icon="fa fa-user-plus fa-lg" plain v-on:click="doLinkUser()">&nbsp;&nbsp;关联用户</el-button>
                                                    <el-button type="primary" size="mini" icon="fa fa-user-times fa-lg" plain v-on:click="doDelLinkUser()">&nbsp;移除用户</el-button>
                                                </el-button-group>
                                            </div>
                                            <div class="col-md-6" style="text-align:right;">
                                                <el-input placeholder="用户名称 筛选" size="mini" clearable v-model="userTableOptions.searchTxt" style="width:300px;" v-on:change="getUserByRole">
                                                    <el-button slot="append" icon="el-icon-search" v-on:click="getUserByRole"></el-button>
                                                </el-input>
                                            </div>
                                        </div>
                                        <el-table v-bind:data="userTableOptions.tableData"
                                                  ref="userInfoDataGrid"
                                                  stripe
                                                  border
                                                  highlight-current-row
                                                  tooltip-effect="light"
                                                  style="width: 100%;height:100%;">
                                            <el-table-column prop="clientId" label="客户ID" align="center" width="200"></el-table-column>
                                            <el-table-column prop="accessTokenLifetime" label="授权token有效期" align="center" width="120">
                                                <template slot-scope="scope">
                                                    {{ scope.row.accessTokenLifetime}}/小时
                                                </template>
                                            </el-table-column>
                                            <el-table-column prop="allowOfflineAccess" label="刷新token" align="center" width="100">
                                                <template slot-scope="scope">
                                                    <el-tag v-bind:type="scope.row.allowOfflineAccess ? 'success' : 'danger'">{{ scope.row.allowOfflineAccess ? '启动' : '禁用' }}</el-tag>
                                                </template>
                                            </el-table-column>
                                            <el-table-column prop="slidingRefreshTokenLifetime" label="刷新token有效期" align="center" width="120">
                                                <template slot-scope="scope">
                                                    {{ scope.row.slidingRefreshTokenLifetime}}/小时
                                                </template>
                                            </el-table-column>
                                            <el-table-column label="启用状态" width="100px" align="center">
                                                <template slot-scope="scope">
                                                    <el-tag v-bind:type="scope.row.isActive ? 'success' : 'danger'">{{ scope.row.isActive ? '启动' : '禁用' }}</el-tag>
                                                </template>
                                            </el-table-column>
                                            <el-table-column prop="description" label="描述"></el-table-column>
                                            <el-table-column label="操作" width="100px" align="center">
                                                <template slot-scope="scopeSub">
                                                    <el-button type="danger" size="mini" icon="fa fa-trash-o fa-lg" ref="btnResourceToClienDel" v-on:click="doResourceToClientDel(scopeSub.row)"></el-button>
                                                </template>
                                            </el-table-column>
                                        </el-table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <el-dialog title="角色基础信息"
               v-bind:visible.sync="roleOptions.formDialog"
               v-bind:width="formWinCol2">
        <div>
            <el-form v-bind:model="roleFormData"
                     v-bind:rules="formRules"
                     ref="formRoleData"
                     label-position="left"
                     v-bind:inline="true"
                     v-bind:status-icon="true"
                     size="medium"
                     label-suffix=":"
                     label-width="100px">
                <el-form-item label="角色名称" prop="flowRoleName">
                    <el-input v-model="roleFormData.flowRoleName" v-bind:style="formFormItem1" clearable v-bind:maxlength="50" show-word-limit>
                    </el-input>
                </el-form-item>
                <el-form-item label="启用状态" prop="isActive">
                    <el-select v-model="roleFormData.isActive"
                               default-first-option
                               v-bind:style="formFormItem1"
                               placeholder="请选择">
                        <el-option label="启用" v-bind:value="true"></el-option>
                        <el-option label="禁用" v-bind:value="false"></el-option>
                    </el-select>
                </el-form-item>
                <el-form-item label="描述" prop="description">
                    <el-input type="textarea" v-model="roleFormData.description" v-bind:style="formFormItem2" clearable v-bind:maxlength="500" show-word-limit>
                    </el-input>
                </el-form-item>

                <!--重置表单时一并清空-->
                <el-form-item label="" prop="id" v-show="false">
                </el-form-item>
            </el-form>
        </div>
        <div slot="footer" style="padding-right:20px;">
            <el-button type="info" v-on:click="roleOptions.formDialog = false" icon="fa fa-share-square-o fa-lg">取 消</el-button>
            <el-button type="primary" v-on:click="doRoleSaveForm()" icon="fa fa-check-square-o fa-lg">确 定</el-button>
        </div>
    </el-dialog>

    {{flowUserSelectOptions.selectData}}
    <flowuserselect v-bind:visible.sync="flowUserSelectOptions.visible" v-model="flowUserSelectOptions.selectData">
    </flowuserselect>


</div>
